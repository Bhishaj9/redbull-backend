<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Recharge</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* ====== Combined styles from both recharge versions (kept everything, normalized selectors) ====== */

    :root {
      --bg-ui: #0b274d;
      --accent: #0e4aa8;
      --purple-700: #0b3d91;
      --purple-600: #0b3d91;
      --muted: #f4f6fb;
      --muted-bg: #f6f4fb;
      --card: #ffffff;
      --shadow: 0 10px 30px rgba(2, 8, 23, 0.35);
      --radius: 12px;
      --text: #1a1430;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,
    body {
      height: 100%;
    }

    body {
      background: linear-gradient(180deg, #faf7ff 0%, #f4f2fb 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }

    /* Top navbar */
    header.app-header {
      position: sticky;
      top: 0;
      left: 0;
      right: 0;
      z-index: 60;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      background: linear-gradient(90deg, var(--accent), var(--bg-ui));
      color: #fff;
      box-shadow: 0 6px 18px rgba(3, 18, 60, 0.12);
      font-weight: 700;
      box-sizing: border-box;
      min-height: 56px;
    }

    header.app-header .back-btn {
      background: transparent;
      border: 0;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
      padding: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
    }

    header.app-header .title {
      flex: 1;
      text-align: left;
      font-size: 18px;
      color: #fff;
    }

    /* Page container */
    .container {
      max-width: 1100px;
      margin: 18px auto;
      padding: 10px;
      width: 94%;
      display: flex;
      gap: 20px;
      align-items: flex-start;
      justify-content: center;
    }

    /* Tabs row */
    .tabs-row {
      display: flex;
      gap: 8px;
      margin-top: 14px;
      margin-bottom: 10px;
    }

    .tab-switch {
      padding: 8px 12px;
      border-radius: 10px;
      border: 1px solid transparent;
      background: transparent;
      cursor: pointer;
      color: var(--bg-ui);
      font-weight: 700;
    }

    .tab-switch.active {
      background: linear-gradient(90deg, var(--accent), var(--bg-ui));
      color: #fff;
      box-shadow: 0 10px 25px rgba(11, 39, 77, 0.12);
    }

    /* Left phone mockup (from second file) */
    .phone {
      width: 360px;
      border-radius: 28px;
      background: linear-gradient(180deg, #fff, #fbfbff);
      box-shadow: 0 30px 60px rgba(64, 14, 120, 0.08);
      padding: 14px;
      border: 8px solid #fff;
      position: relative;
      overflow: hidden;
      box-sizing: border-box;
    }

    .phone .header {
      height: 56px;
      background: linear-gradient(90deg, var(--purple-700), var(--purple-600));
      color: #fff;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px;
      border-radius: 12px;
      font-weight: 800;
    }

    .phone .header .logo {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: #fff;
      color: var(--purple-700);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
    }

    .phone .body {
      padding: 12px;
    }

    .label {
      font-weight: 700;
      color: #3b2d4d;
      margin-top: 12px;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .input {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #efeaf8;
      background: #fbf9ff;
      font-size: 15px;
      color: #382a50;
      box-sizing: border-box;
    }

    .preset-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .preset {
      flex: 1;
      padding: 10px 12px;
      background: #fff;
      border-radius: 999px;
      border: 1px solid #efeaf8;
      font-weight: 800;
      text-align: center;
      cursor: pointer;
    }

    .preset.active {
      background: linear-gradient(90deg, var(--accent), var(--purple-600));
      color: #fff;
      box-shadow: 0 12px 30px rgba(111, 43, 220, 0.18);
      transform: translateY(-2px);
    }

    .pay-btn {
      margin-top: 14px;
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 0;
      background: linear-gradient(90deg, var(--purple-600), var(--accent));
      color: #fff;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 12px 30px rgba(111, 43, 220, 0.18);
    }

    .small-note {
      font-size: 12px;
      color: #6b5b7a;
      margin-top: 10px;
    }

    /* Right QR & summary card (from second file) */
    .qr-side {
      width: 420px;
      background: linear-gradient(180deg, #fff, #fcfbff);
      border-radius: 20px;
      padding: 28px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 18px;
      box-shadow: 0 40px 80px rgba(99, 33, 147, 0.06);
      box-sizing: border-box;
    }

    .qr-side .badge {
      background: linear-gradient(90deg, var(--purple-600), var(--accent));
      color: #fff;
      padding: 12px 22px;
      border-radius: 12px;
      font-weight: 800;
      box-shadow: 0 12px 30px rgba(111, 43, 220, 0.12);
    }

    .qr-card {
      width: 260px;
      height: 260px;
      border-radius: 14px;
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 24px 60px rgba(99, 33, 147, 0.08);
    }

    .qr-img {
      width: 220px;
      height: 220px;
      object-fit: cover;
      border-radius: 8px;
    }

    .qr-meta {
      font-size: 13px;
      color: #0b3d91;
      text-align: center;
    }

    /* Recharge card, payment methods and modal (from first file) */
    .amount-box {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: flex-start;
      background: transparent;
      padding: 6px 0;
      margin-bottom: 18px;
    }

    .amt-btn {
      padding: 12px 22px;
      border-radius: 40px;
      border: 1px solid rgba(11, 39, 77, 0.08);
      background: #fff;
      font-size: 15px;
      font-weight: 700;
      color: var(--bg-ui);
      box-shadow: 0 2px 6px rgba(2, 8, 23, 0.04);
      cursor: pointer;
      transition: transform .12s, box-shadow .12s;
    }

    .amt-btn:hover {
      transform: translateY(-2px);
    }

    .amt-btn.active {
      background: linear-gradient(180deg, var(--accent), var(--bg-ui));
      color: #fff;
      box-shadow: 0 12px 30px rgba(11, 39, 77, 0.28);
    }

    .rech-card {
      background: var(--card);
      padding: 18px;
      border-radius: 14px;
      margin-bottom: 16px;
      box-shadow: 0 6px 18px rgba(2, 8, 23, 0.04);
      box-sizing: border-box;
    }

    .balance-label {
      color: #556;
      margin-bottom: 10px;
    }

    .balance-label span {
      color: var(--bg-ui);
      font-weight: 800;
    }

    .input-box {
      display: flex;
      align-items: center;
      gap: 8px;
      border-radius: 10px;
      border: 1px solid #e6e9f2;
      padding: 8px 10px;
      background: #fff;
    }

    .input-box .rs {
      font-weight: 700;
      color: var(--bg-ui);
    }

    input[type="number"]#amountInput {
      border: 0;
      outline: 0;
      font-size: 16px;
      padding: 10px 6px;
      width: 100%;
      background: transparent;
    }

    .pay-btn.full {
      width: 100%;
      margin-top: 10px;
      background: linear-gradient(180deg, var(--bg-ui), var(--accent));
      color: #fff;
      border: none;
      padding: 14px;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: var(--shadow);
      font-size: 16px;
    }

    .pay-methods {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    .pay-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 112px;
      height: 88px;
      border-radius: 12px;
      background: #fff;
      border: 1px solid #eef2ff;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.03);
      padding: 10px;
      transition: transform .12s, box-shadow .12s, border-color .12s;
    }

    .pay-option:focus {
      outline: 3px solid rgba(14, 74, 168, 0.12);
      outline-offset: 2px;
    }

    .pay-option .pay-icon {
      width: 48px;
      height: 48px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 18px;
      color: #fff;
      background: linear-gradient(180deg, #0e4aa8, #0b274d);
      box-shadow: 0 6px 14px rgba(11, 39, 77, 0.18);
    }

    .pay-option .pay-label {
      font-size: 13px;
      font-weight: 800;
      color: #0b274d;
    }

    .pay-option.active {
      border-color: rgba(14, 74, 168, 0.22);
      transform: translateY(-4px);
      box-shadow: 0 16px 40px rgba(11, 39, 77, 0.18);
    }

    /* Modal overlay & modal */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(8, 16, 36, 0.55);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 200;
      visibility: hidden;
      opacity: 0;
      transition: opacity .18s, visibility .18s;
    }

    .overlay.show {
      visibility: visible;
      opacity: 1;
    }

    .modal {
      width: 840px;
      max-width: 95%;
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      box-shadow: 0 30px 70px rgba(2, 6, 23, 0.6);
      background: linear-gradient(90deg, #0f3a72 0%, #08406b 60%);
      box-sizing: border-box;
    }

    .modal-left {
      flex: 0 0 320px;
      padding: 22px;
      color: #fff;
      background: linear-gradient(180deg, #0f3a72, #0a2f58);
      display: flex;
      flex-direction: column;
      gap: 18px;
      position: relative;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand .avatar {
      width: 44px;
      height: 44px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.06);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
    }

    .price-summary {
      background: rgba(255, 255, 255, 0.06);
      padding: 12px;
      border-radius: 10px;
      font-weight: 700;
    }

    .phone-row {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.03);
      padding: 10px;
      border-radius: 10px;
      color: #d9e9ff;
      font-size: 14px;
    }

    .left-art {
      position: absolute;
      right: -40px;
      bottom: -22px;
      opacity: 0.85;
      width: 220px;
      filter: drop-shadow(0 20px 40px rgba(2, 8, 23, 0.45));
    }

    .secure-note {
      font-size: 12px;
      opacity: 0.9;
      margin-top: auto;
      color: rgba(255, 255, 255, 0.9);
    }

    .modal-right {
      flex: 1;
      background: #fff;
      padding: 20px 22px;
      color: #122;
      box-sizing: border-box;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .modal-header h3 {
      margin: 0;
      font-size: 15px;
      color: #123;
    }

    .close-x {
      background: transparent;
      border: 0;
      font-size: 20px;
      color: #444;
      cursor: pointer;
    }

    .form-row {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }

    .card-input {
      width: 100%;
      border: 1px solid #e6ecf5;
      padding: 12px 10px;
      border-radius: 8px;
      font-size: 14px;
      box-sizing: border-box;
    }

    .row-2 {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .col {
      flex: 1;
    }

    .save-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 12px;
      color: #556;
    }

    .continue-btn {
      margin-top: 14px;
      background: linear-gradient(180deg, var(--bg-ui), var(--accent));
      color: #fff;
      border: 0;
      padding: 12px 16px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
      width: 180px;
    }

    /* Confirmation popup */
    .confirm-overlay {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 260;
      visibility: hidden;
      opacity: 0;
      transition: opacity .12s, visibility .12s;
    }

    .confirm-overlay.show {
      visibility: visible;
      opacity: 1;
    }

    .confirm-card {
      width: 520px;
      max-width: 94%;
      background: #fff;
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 18px 60px rgba(0, 0, 0, 0.28);
    }

    .confirm-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .confirm-body {
      font-size: 14px;
      color: #333;
      line-height: 1.4;
      margin-bottom: 14px;
    }

    .confirm-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .btn-ghost {
      padding: 10px 14px;
      border-radius: 10px;
      background: #f2f4fb;
      border: 1px solid #e6eaf7;
      cursor: pointer;
    }

    .btn-primary {
      padding: 10px 14px;
      border-radius: 10px;
      background: linear-gradient(90deg, var(--accent), var(--bg-ui));
      color: #fff;
      border: 0;
      cursor: pointer;
    }

    /* Toast */
    .toast {
      position: fixed;
      right: 18px;
      bottom: 18px;
      background: linear-gradient(90deg, var(--accent), var(--bg-ui));
      color: #fff;
      padding: 10px 14px;
      border-radius: 10px;
      box-shadow: 0 14px 40px rgba(2, 6, 23, 0.4);
      z-index: 400;
      transform: translateY(8px);
      opacity: 0;
      transition: opacity .18s, transform .18s;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* Responsive adjustments */
    @media (max-width:1000px) {
      .container {
        flex-direction: column;
        align-items: center;
      }

      .qr-side,
      .phone {
        width: 92%;
      }
    }

    @media (max-width:720px) {
      .modal {
        flex-direction: column;
        width: 95%;
      }

      .modal-left {
        flex: 0 0 auto;
        padding: 14px;
        order: 2;
      }

      .modal-right {
        order: 1;
        padding: 16px;
      }

      .left-art {
        display: none;
      }

      .pay-option {
        width: 30%;
        min-width: 90px;
      }
    }
  </style>
</head>

<body>

  <!-- Top navbar -->
  <header class="app-header top-back">
    <button class="back-btn" id="backBtn" aria-label="Back">‚Üê</button>
    <div class="title">Recharge</div>
    <div style="min-width:36px;"></div>
  </header>

  <!-- Tabs (keeps the tab-switch logic from first file) -->
  <div class="tabs-row" style="width:94%;max-width:1100px;margin:14px auto 0;">
    <button class="tab-switch active" data-target="rechSection">Recharge</button>
    <button class="tab-switch" data-target="withSection">Withdraw</button>
  </div>

  <div class="container">

    <!-- Left: phone mockup + form (from second file) -->
    <div class="phone" role="region" aria-label="Payment form">
      <div class="header">
        <div class="logo">R</div>
        <div style="flex:1">Invest Privately Limited</div>
        <div style="opacity:0.9;font-weight:700">‚úï</div>
      </div>

      <div class="body">

        <!-- Amount presets (keeps both amt-btn and preset concepts) -->
        <div class="label">Amount</div>
        <input id="amountInput" class="input" type="number" inputmode="numeric" placeholder="Enter amount" />
        <div class="preset-row" aria-hidden="false" style="margin-bottom:12px;">
          <div class="preset amt-btn" data-value="480">480</div>
          <div class="preset amt-btn" data-value="1980">1,980</div>
          <div class="preset amt-btn" data-value="4970">4,970</div>
          <div class="preset amt-btn" data-value="13680">13,680</div>
        </div>

        <div class="label">Customer Mobile Number</div>
        <input id="custPhone" class="input" type="tel" placeholder="+91 **********" />

        <div class="label">Select Payment Method</div>
        <div style="background:#fff;border-radius:10px;border:1px solid #efeaf8;padding:6px;">
          <label style="display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;">
            <input type="radio" name="payMethod" value="upi" />
            <div style="font-weight:700">UPI</div>
          </label>
          <label style="display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;">
            <input type="radio" name="payMethod" value="cards" />
            <div style="font-weight:700">Cards</div>
          </label>
          <label
            style="display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;background:#fbf9ff;border:1px solid rgba(111,43,220,0.08);">
            <input type="radio" name="payMethod" value="qr" checked />
            <div style="font-weight:800;color:var(--purple-700)">QR</div>
          </label>
        </div>

        <button id="openPay" class="pay-btn">Continue to Pay</button>
        <div class="small-note">Dynamic QR code generated. Secure & fast payments.</div>
      </div>
    </div>

    <!-- Right: QR & summary (from second file) -->
    <div class="qr-side" aria-hidden="false">
      <div class="badge">Dynamic QR Code Generated</div>

      <div class="qr-card" id="qrCard">
        <img id="qrImage" class="qr-img" src="/mnt/data/f292bc17-f026-4a9d-8e56-c4c91709368a.png" alt="QR code" />
      </div>

      <div class="qr-meta">
        <div style="font-weight:800;font-size:15px" id="qrAmount">‚Çπ 0</div>
        <div style="color:#7b5ea0;margin-top:6px">Scan the QR with any UPI app or copy the UPI ID</div>
      </div>

      <div style="display:flex;gap:10px;width:100%;justify-content:center;">
        <button id="copyUpi" class="pay-btn"
          style="width:auto;padding:10px 16px;background:#fff;color:var(--purple-700);border:1px solid rgba(111,43,220,0.12);box-shadow:none;font-weight:800;">Copy
          UPI ID</button>
        <button id="paidBtn" class="pay-btn" style="width:auto;padding:10px 16px;">I have Paid</button>
      </div>
    </div>
  </div>

  <!-- Recharge section content and payment methods / modal (from first file) -->
  <div id="rechSection" style="display:none;">
    <!-- invisible duplicate area intentionally omitted visually; core modal and flows kept below -->
  </div>

  <section id="withSection" class="tab-content" style="display:none; width:94%; max-width:1100px; margin: 20px auto;">
    <div class="rech-card" style="padding:18px;">
      <h3 style="margin-top:0;">Withdraw</h3>
      <p style="margin-top:6px;"><strong id="walletBalanceDisplay">Wallet Balance: ‚Çπ 0</strong></p>
      <input id="withAmount" type="number" placeholder="Enter withdrawal amount"
        style="width:100%;padding:12px;margin-top:10px;border-radius:8px;border:1px solid #ccc;" />
      <input id="withTarget" type="text" placeholder="Enter UPI ID or Bank Account"
        style="width:100%;padding:12px;margin-top:10px;border-radius:8px;border:1px solid #ccc;" />
      <button id="withdrawNowBtn" class="pay-btn" style="width:100%;margin-top:16px;">Withdraw Now</button>
    </div>
  </section>

  <!-- Modal overlay (from first file) -->
  <div id="paymentOverlay" class="overlay" role="dialog" aria-hidden="true" aria-labelledby="payTitle">
    <div class="modal" role="document" aria-modal="true">
      <div class="modal-left" aria-hidden="false">
        <div class="brand">
          <div class="avatar">D</div>
          <div>
            <div style="font-weight:800;font-size:15px;">Demo Shop</div>
            <div style="font-size:12px;opacity:0.9;">Price Summary</div>
          </div>
        </div>

        <div class="price-summary" id="modalPrice">‚Çπ 0.00</div>

        <div class="phone-row">Using as +91 ‚Ä¢ <span id="modalPhone" style="margin-left:6px;">**********</span></div>

        <img src="/mnt/data/WhatsApp Image 2025-11-17 at 17.20.54_770effb8.jpg" alt="" class="left-art" />

        <div class="secure-note">Secured by <strong>Razorpay</strong></div>
      </div>

      <div class="modal-right">
        <div class="modal-header">
          <h3 id="payTitle">Payment Options</h3>
          <button class="close-x" id="modalClose" aria-label="Close">‚úï</button>
        </div>

        <div id="paymentFormContainer" aria-live="polite">
          <div style="color:#556">Choose a payment method to see required fields here.</div>
        </div>

        <div id="modalActions" style="display:flex; justify-content:flex-end; margin-top:12px;"></div>
      </div>
    </div>
  </div>

  <!-- Confirmation overlay -->
  <div id="confirmOverlay" class="confirm-overlay" aria-hidden="true">
    <div class="confirm-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <div class="confirm-header">
        <div id="confirmTitle" style="font-weight:800">Confirm Payment</div>
        <div style="color:#666" id="confirmIcon">üîí</div>
      </div>
      <div class="confirm-body" id="confirmBody"></div>
      <div class="confirm-actions">
        <button class="btn-ghost" id="confirmCancel">Cancel</button>
        <button class="btn-primary" id="confirmProceed">Confirm & Pay</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">Payment successful</div>
  ```
  /* Responsive adjustments */
  @media (max-width:1000px) {
  .container {
  flex-direction: column;
  align-items: center;
  }

  .qr-side,
  .phone {
  width: 92%;
  }
  }

  @media (max-width:720px) {
  .modal {
  flex-direction: column;
  width: 95%;
  }

  .modal-left {
  flex: 0 0 auto;
  padding: 14px;
  order: 2;
  }

  .modal-right {
  order: 1;
  padding: 16px;
  }

  .left-art {
  display: none;
  }

  .pay-option {
  width: 30%;
  min-width: 90px;
  }
  }
  </style>
  </head>

  <body>

    <!-- Top navbar -->
    <header class="app-header top-back">
      <button class="back-btn" id="backBtn" aria-label="Back">‚Üê</button>
      <div class="title">Recharge</div>
      <div style="min-width:36px;"></div>
    </header>

    <!-- Tabs (keeps the tab-switch logic from first file) -->
    <div class="tabs-row" style="width:94%;max-width:1100px;margin:14px auto 0;">
      <button class="tab-switch active" data-target="rechSection">Recharge</button>
      <button class="tab-switch" data-target="withSection">Withdraw</button>
    </div>

    <div class="container">

      <!-- Left: phone mockup + form (from second file) -->
      <div class="phone" role="region" aria-label="Payment form">
        <div class="header">
          <div class="logo">R</div>
          <div style="flex:1">Invest Privately Limited</div>
          <div style="opacity:0.9;font-weight:700">‚úï</div>
        </div>

        <div class="body">

          <!-- Amount presets (keeps both amt-btn and preset concepts) -->
          <div class="label">Amount</div>
          <input id="amountInput" class="input" type="number" inputmode="numeric" placeholder="Enter amount" />
          <div class="preset-row" aria-hidden="false" style="margin-bottom:12px;">
            <div class="preset amt-btn" data-value="480">480</div>
            <div class="preset amt-btn" data-value="1980">1,980</div>
            <div class="preset amt-btn" data-value="4970">4,970</div>
            <div class="preset amt-btn" data-value="13680">13,680</div>
          </div>

          <div class="label">Customer Mobile Number</div>
          <input id="custPhone" class="input" type="tel" placeholder="+91 **********" />

          <div class="label">Select Payment Method</div>
          <div style="background:#fff;border-radius:10px;border:1px solid #efeaf8;padding:6px;">
            <label style="display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;">
              <input type="radio" name="payMethod" value="upi" />
              <div style="font-weight:700">UPI</div>
            </label>
            <label style="display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;">
              <input type="radio" name="payMethod" value="cards" />
              <div style="font-weight:700">Cards</div>
            </label>
            <label
              style="display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;background:#fbf9ff;border:1px solid rgba(111,43,220,0.08);">
              <input type="radio" name="payMethod" value="qr" checked />
              <div style="font-weight:800;color:var(--purple-700)">QR</div>
            </label>
          </div>

          <button id="openPay" class="pay-btn">Continue to Pay</button>
          <div class="small-note">Dynamic QR code generated. Secure & fast payments.</div>
        </div>
      </div>

      <!-- Right: QR & summary (from second file) -->
      <div class="qr-side" aria-hidden="false">
        <div class="badge">Dynamic QR Code Generated</div>

        <div class="qr-card" id="qrCard">
          <img id="qrImage" class="qr-img" src="/mnt/data/f292bc17-f026-4a9d-8e56-c4c91709368a.png" alt="QR code" />
        </div>

        <div class="qr-meta">
          <div style="font-weight:800;font-size:15px" id="qrAmount">‚Çπ 0</div>
          <div style="color:#7b5ea0;margin-top:6px">Scan the QR with any UPI app or copy the UPI ID</div>
        </div>

        <div style="display:flex;gap:10px;width:100%;justify-content:center;">
          <button id="copyUpi" class="pay-btn"
            style="width:auto;padding:10px 16px;background:#fff;color:var(--purple-700);border:1px solid rgba(111,43,220,0.12);box-shadow:none;font-weight:800;">Copy
            UPI ID</button>
          <button id="paidBtn" class="pay-btn" style="width:auto;padding:10px 16px;">I have Paid</button>
        </div>
      </div>
    </div>

    <!-- Recharge section content and payment methods / modal (from first file) -->
    <div id="rechSection" style="display:none;">
      <!-- invisible duplicate area intentionally omitted visually; core modal and flows kept below -->
    </div>

    <section id="withSection" class="tab-content" style="display:none; width:94%; max-width:1100px; margin: 20px auto;">
      <div class="rech-card" style="padding:18px;">
        <h3 style="margin-top:0;">Withdraw</h3>
        <p style="margin-top:6px;"><strong id="walletBalanceDisplay">Wallet Balance: ‚Çπ 0</strong></p>
        <input id="withAmount" type="number" placeholder="Enter withdrawal amount"
          style="width:100%;padding:12px;margin-top:10px;border-radius:8px;border:1px solid #ccc;" />
        <input id="withTarget" type="text" placeholder="Enter UPI ID or Bank Account"
          style="width:100%;padding:12px;margin-top:10px;border-radius:8px;border:1px solid #ccc;" />
        <button id="withdrawNowBtn" class="pay-btn" style="width:100%;margin-top:16px;">Withdraw Now</button>
      </div>
    </section>

    <!-- Modal overlay (from first file) -->
    <div id="paymentOverlay" class="overlay" role="dialog" aria-hidden="true" aria-labelledby="payTitle">
      <div class="modal" role="document" aria-modal="true">
        <div class="modal-left" aria-hidden="false">
          <div class="brand">
            <div class="avatar">D</div>
            <div>
              <div style="font-weight:800;font-size:15px;">Demo Shop</div>
              <div style="font-size:12px;opacity:0.9;">Price Summary</div>
            </div>
          </div>

          <div class="price-summary" id="modalPrice">‚Çπ 0.00</div>

          <div class="phone-row">Using as +91 ‚Ä¢ <span id="modalPhone" style="margin-left:6px;">**********</span></div>

          <img src="/mnt/data/WhatsApp Image 2025-11-17 at 17.20.54_770effb8.jpg" alt="" class="left-art" />

          <div class="secure-note">Secured by <strong>Razorpay</strong></div>
        </div>

        <div class="modal-right">
          <div class="modal-header">
            <h3 id="payTitle">Payment Options</h3>
            <button class="close-x" id="modalClose" aria-label="Close">‚úï</button>
          </div>

          <div id="paymentFormContainer" aria-live="polite">
            <div style="color:#556">Choose a payment method to see required fields here.</div>
          </div>

          <div id="modalActions" style="display:flex; justify-content:flex-end; margin-top:12px;"></div>
        </div>
      </div>
    </div>

    <!-- Confirmation overlay -->
    <div id="confirmOverlay" class="confirm-overlay" aria-hidden="true">
      <div class="confirm-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
        <div class="confirm-header">
          <div id="confirmTitle" style="font-weight:800">Confirm Payment</div>
          <div style="color:#666" id="confirmIcon">üîí</div>
        </div>
        <div class="confirm-body" id="confirmBody"></div>
        <div class="confirm-actions">
          <button class="btn-ghost" id="confirmCancel">Cancel</button>
          <button class="btn-primary" id="confirmProceed">Confirm & Pay</button>
        </div>
      </div>
    </div>

    <div id="toast" class="toast" role="status" aria-live="polite">Payment successful</div>

    <script src="script.js"></script>

    <script>
      /* ===== Combined JS logic for Manual UPI ===== */

      (function () {
        // Basic element refs
        const presets = document.querySelectorAll('.preset.amt-btn');
        const amtBtns = document.querySelectorAll('.amt-btn');
        const amountInput = document.getElementById('amountInput');
        const openPay = document.getElementById('openPay');
        const qrAmount = document.getElementById('qrAmount');
        const copyUpi = document.getElementById('copyUpi');
        const paidBtn = document.getElementById('paidBtn');
        const qrImage = document.getElementById('qrImage');
        const custPhone = document.getElementById('custPhone');
        const backBtn = document.getElementById('backBtn');
        const tabs = document.querySelectorAll('.tab-switch');
        const sections = document.querySelectorAll('.tab-content');
        const paymentOverlay = document.getElementById('paymentOverlay');
        const modalClose = document.getElementById('modalClose');
        const modalPrice = document.getElementById('modalPrice');
        const modalPhone = document.getElementById('modalPhone');
        const modalActions = document.getElementById('modalActions');
        const formContainer = document.getElementById('paymentFormContainer');
        const withBtn = document.getElementById('withdrawNowBtn');
        const walletBalanceDisplay = document.getElementById('walletBalanceDisplay');

        // Default UPI & QR image provided by global API object if present
        const DEFAULT_UPI = window.SIMPLE_RECHARGE_API ? window.SIMPLE_RECHARGE_API.DEFAULT_UPI : 'example@bank';
        if (window.SIMPLE_RECHARGE_API && window.SIMPLE_RECHARGE_API.QR_IMAGE_PATH) {
          qrImage.src = window.SIMPLE_RECHARGE_API.QR_IMAGE_PATH;
        }

        // Tab switching
        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            sections.forEach(s => { s.style.display = 'none'; s.classList.remove('active'); });
            tab.classList.add('active');
            const target = document.getElementById(tab.dataset.target);
            if (target) { target.style.display = 'block'; target.classList.add('active'); }
          });
        });

        // Back button
        backBtn.addEventListener('click', () => {
          if (history.length > 1) history.back();
          else window.location.href = 'home.html';
        });

        // Presets & amount UI
        function setSelectedAmount(val) {
          amountInput.value = val;
          updateQrAmount();
          amtBtns.forEach(b => b.classList.toggle('active', b.dataset.value === String(val)));
          presets.forEach(p => p.classList.toggle('active', p.dataset.value === String(val)));
        }

        presets.forEach(p => {
          p.addEventListener('click', () => setSelectedAmount(p.dataset.value));
        });

        amtBtns.forEach(btn => {
          btn.addEventListener('click', () => setSelectedAmount(btn.dataset.value));
        });

        amountInput.addEventListener('input', updateQrAmount);
        function updateQrAmount() {
          const v = Number(amountInput.value) || 0;
          qrAmount.textContent = '‚Çπ ' + v.toLocaleString();
        }
        updateQrAmount();

        // Copy UPI
        copyUpi.addEventListener('click', async () => {
          const upi = DEFAULT_UPI;
          try {
            if (navigator.clipboard && navigator.clipboard.writeText) await navigator.clipboard.writeText(upi);
            else {
              const t = document.createElement('textarea'); t.value = upi; document.body.appendChild(t); t.select(); document.execCommand('copy'); document.body.removeChild(t);
            }
            showToast('UPI copied');
          } catch (e) { alert('Copy failed'); }
        });

        // "I have Paid" -> Open Manual UTR Modal
        paidBtn.addEventListener('click', () => {
          const amt = Number(amountInput.value) || 0;
          if (amt <= 0) return alert('Enter amount first');
          openManualRechargeModal(amt);
        });

        // "Continue to Pay" -> Also Open Manual UTR Modal (Unified flow)
        openPay.addEventListener('click', () => {
          const amt = Number(amountInput.value) || 0;
          if (amt <= 0) return alert('Enter amount first');
          openManualRechargeModal(amt);
        });

        function openManualRechargeModal(amount) {
          modalPrice.textContent = '‚Çπ ' + amount.toFixed(2);
          modalPhone.textContent = (custPhone.value && custPhone.value.trim()) ? custPhone.value.trim() : '**********';
          paymentOverlay.classList.add('show');
          paymentOverlay.setAttribute('aria-hidden', 'false');
          renderManualForm(amount);
        }

        function closePaymentModal() {
          paymentOverlay.classList.remove('show');
          paymentOverlay.setAttribute('aria-hidden', 'true');
        }
        modalClose.addEventListener('click', closePaymentModal);
        paymentOverlay.addEventListener('click', (e) => { if (e.target === paymentOverlay) closePaymentModal(); });

        function renderManualForm(amount) {
          modalActions.innerHTML = '';
          formContainer.innerHTML = `
          <div style="padding:10px 0; color:#333;">
            <p>You are requesting to add <strong>‚Çπ ${amount.toFixed(2)}</strong> to your wallet.</p>
            <p style="font-size:13px;color:#666;margin-top:6px;">Please pay via UPI/QR and enter the Transaction ID (UTR) below.</p>
            <input id="utrInput" type="text" placeholder="Enter 12-digit UTR / Ref No." 
              style="width:100%;padding:12px;margin-top:12px;border:1px solid #ccc;border-radius:8px;font-size:15px;" />
          </div>
        `;
          const submit = document.createElement('button');
          submit.className = 'continue-btn';
          submit.textContent = 'Submit Request';
          submit.onclick = () => submitRechargeRequest(amount);
          modalActions.appendChild(submit);
        }

        async function submitRechargeRequest(amount) {
          const utrInput = document.getElementById('utrInput');
          const utr = utrInput.value.trim();
          if (!utr || utr.length < 4) return alert('Please enter a valid UTR / Transaction ID');

          const btn = document.querySelector('.continue-btn');
          if (btn) { btn.disabled = true; btn.textContent = 'Submitting...'; }

          try {
            const fetchFn = window.apiFetch || fetch;
            const res = await fetchFn('/api/purchases/recharge-request', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ amount, utr })
            });
            const data = await res.json();

            if (res.ok) {
              closePaymentModal();
              showToast('Request Submitted! Waiting for approval.');
              // Optional: Clear inputs
              amountInput.value = '';
              updateQrAmount();
            } else {
              alert('Error: ' + (data.message || 'Failed'));
            }
          } catch (e) {
            console.error(e);
            alert('Network error');
          } finally {
            if (btn) { btn.disabled = false; btn.textContent = 'Submit Request'; }
          }
        }

        // Withdraw flow
        if (withBtn) {
          withBtn.addEventListener('click', async () => {
            const amount = Number(document.getElementById('withAmount').value);
            const target = document.getElementById('withTarget').value;
            if (!amount || amount <= 0) { alert('Enter valid amount'); return; }
            if (!target) { alert('Enter UPI ID or Bank Account'); return; }
            withBtn.disabled = true;
            withBtn.textContent = 'Requesting...';
            try {
              const fetchFn = window.apiFetch || fetch;
              const res = await fetchFn('/api/withdraws/request', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ amount: amount, method: 'upi', details: { upi: target } })
              });
              const data = await res.json();
              if (res.ok) {
                alert('Withdrawal requested successfully!');
                document.getElementById('withAmount').value = '';
                document.getElementById('withTarget').value = '';
                loadBalance();
              } else {
                alert('Error: ' + (data.message || 'Failed'));
              }
            } catch (e) {
              console.error(e);
              alert('Network error');
            } finally {
              withBtn.disabled = false;
              withBtn.textContent = 'Withdraw Now';
            }
          });
        }

        // Load balance
        async function loadBalance() {
          try {
            const fetchFn = window.apiFetch || fetch;
            const res = await fetchFn('/api/auth/me');
            if (res.ok) {
              const data = await res.json();
              if (data.user) {
                const bal = '‚Çπ ' + (data.user.wallet || 0).toFixed(2);
                const balanceDisplayEl = document.getElementById('walletBalanceDisplay');
                if (balanceDisplayEl) balanceDisplayEl.textContent = 'Wallet Balance: ' + bal;
                if (modalPhone) modalPhone.textContent = data.user.phone;
              }
            }
          } catch (e) {
            console.error('Load balance error', e);
          }
        }

        function showToast(msg, ms = 3000) {
          const t = document.getElementById('toast');
          if (!t) return;
          t.textContent = msg;
          t.classList.add('show');
          setTimeout(() => t.classList.remove('show'), ms);
        }

        document.addEventListener('DOMContentLoaded', () => {
          loadBalance();
          const walletOpt = document.querySelector('.pay-option[data-method="wallet"]');
          if (walletOpt) walletOpt.style.display = 'none';
        });

      })();
    </script>
  </body>

</html>
```